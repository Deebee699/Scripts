{"version":"0.2.0","body":"async function main(workbook: ExcelScript.Workbook) {\n    \n    // Set the OpenAI API key\n    const apiKey = workbook.getWorksheet(\"API\").getRange(\"B1\").getValue();\n    const endpoint: string = \"https://api.openai.com/v1/completions\";\n\n    // get worksheet info\n    const sheet = workbook.getWorksheet(\"Prompt\");\n    // the ask\n    const mytext = sheet.getRange(\"B2\").getValue();\n\n    // useful if if we get more than one row back\n    const result = workbook.getWorksheet(\"Result\");\n    result.getRange(\"A1:D1000\").clear();\n    sheet.getRange(\"B3\").setValue(\" \")\n\n    // Set the model engine and prompt\n    const model: string = \"text-davinci-002\";\n  const prompt: (string | boolean | number) = mytext;\n\n    // Set the HTTP headers\n    const headers: Headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"Authorization\", `Bearer ${apiKey}`);\n\n    // Set the HTTP body\n  const body: (string | boolean | number) = JSON.stringify({\n        model: model,\n        prompt: prompt,\n        max_tokens: 1024,\n        n: 1,\n        temperature: 0.5,\n    });\n\n    // Send the HTTP request\n    const response: Response = await fetch(endpoint, {\n        method: \"POST\",\n        headers: headers,\n        body: body,\n    });\n\n    // Parse the response as JSON\n  const json: { choices: { text:(string | boolean | number )}[] } = await response.json();\n\n    // Get the answer - i.e. output\n    const text: (string | boolean | number) = json.choices[0].text;\n\n    // Output the generated text\n   // console.log(text);\n  \n   const output = sheet.getRange(\"B4\");\n   \n   output.setValue(text);\n\n\n  const cell = sheet.getRange(\"B4\");\n\n  // Split the cell contents by new line\n\n  const arr = cell.getValue().toString().split(\"\\n\");\n\n  const newcell = result.getRange(\"A1\");\n\n  var offset = 0;\n  // console.log (arr)\n\n  for (let i = 0; i < arr.length; i++) {\n    // Write the value to the next cell\n   \n    if (arr[i].length > 0) {\n      newcell.getOffsetRange(offset, 0).setValue(arr[i]);\n    \n      offset++;\n    }\n  }\n\n // console.log(offset)\n  if (offset > 1) {\n    sheet.getRange(\"B3\").setValue(\"Check 'Result' sheet to get answers separated by multiple rows\")\n\n  }\n}\n\n\n","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}